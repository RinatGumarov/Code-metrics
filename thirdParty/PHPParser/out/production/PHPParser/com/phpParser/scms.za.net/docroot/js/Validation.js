function validate(frm,page){var small=/[a-z]+/;var caps=/[A-Z]+/;var num=/[0-9]+/;var email=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var minPassLen=8;switch(page){case'login':if(frm.user.value.length==0){alert("Please enter a username!");frm.user.focus();return false}else if(frm.passwd.value.length==0){alert("Please enter a passwd!");frm.passwd.focus();return false}return validateCaptcha(frm);break;case'role':if(frm.role.value.length==0){alert("Please enter a role name!");frm.role.focus();return false}else if(frm.role.value.length<4||frm.role.value.length>30){alert("Role name must be between 4 and 30 characters long!");if(frm.role.value.length){frm.role.select()}frm.role.focus();return false}return validateCaptcha(frm);break;case'user':var userUpdate=/users\/edit/;if(frm.role.value==0){alert("Please select a user role!");frm.role.focus();return false}else if(frm.user.value.length==0){alert("Please enter a username!");frm.user.focus();return false}else if(frm.user.value.length<4||frm.user.value.length>20){alert("Username must be between 4 and 20 characters long!");frm.user.select();frm.user.focus();return false}else if((!userUpdate.test(window.location.toString())&&frm.password.value.length<minPassLen)||(userUpdate.test(window.location.toString())&&frm.password.value.length>0&&frm.password.value.length<minPassLen)){alert("Password must be at least "+minPassLen+" characters long!");frm.password.select();frm.password.focus();return false}else if((!userUpdate.test(window.location.toString())&&(!small.test(frm.password.value)||!caps.test(frm.password.value)||!num.test(frm.password.value)))||(userUpdate.test(window.location.toString())&&frm.password.value.length>0&&(!small.test(frm.password.value)||!caps.test(frm.password.value)||!num.test(frm.password.value)))){alert("Password must contain small and capital letters as well as a digit!");frm.password.select();frm.password.focus();return false}else if(frm.email.value.length==0){alert("Please enter an email address!");frm.email.focus();return false}else if(!email.test(frm.email.value)){alert("Please enter a valid email address!");frm.email.select();frm.email.focus();return false}return validateCaptcha(frm);break;case'remind':if(frm.user.value.length==0){alert("Please enter a username!");frm.user.focus();return false}else if(frm.email.value.length==0){alert("Please enter an email!");frm.email.focus();return false}else if(!email.test(frm.email.value)){alert("Please enter a valid email address!");frm.email.select();frm.email.focus();return false}return validateCaptcha(frm);break;case'changer':if(frm.password.value.length==0){alert("Please enter a new password!");frm.password.focus();return false}else if(frm.password.value.length<minPassLen){alert("Password must be at least "+minPassLen+" characters long!");frm.password.select();frm.password.focus();return false}else if(frm.confirm.value.length==0){alert("Please confirm your new password!");frm.confirm.focus();return false}else if(frm.password.value!=frm.confirm.value){alert("Passwords do not match!");if(frm.confirm.value.length>0){frm.confirm.select()}frm.confirm.focus();return false}else if((!small.test(frm.password.value)||!caps.test(frm.password.value)||!num.test(frm.password.value))){alert("Password must contain small and capital letters as well as a digit!");frm.password.select();frm.password.focus();return false}return validateCaptcha(frm);break}return true}function validateCaptcha(frm){if(frm.captcha&&frm.captcha.value.length!=5){alert("Please complete the Automated Public Turing Test!");if(frm.captcha.value.length){frm.captcha.select()}frm.captcha.focus();return false}return true}